# Main Branch Contents

This document explains what files are included in the main branch vs what gets generated by tutorial steps.

## Files in Main Branch (Template/Tutorial Foundation)

### Database Migrations (Tutorial Data)
✅ **Included in main**
- `priv/repo/migrations/*_create_comments.exs` - Polymorphic comments demo table
- `priv/repo/migrations/*_create_flag_types.exs` - EAV flag types registry
- `priv/repo/migrations/*_create_product_flags.exs` - EAV product flags values

**Why:** These provide realistic data for demonstrating polymorphic join modes in the tutorial.

### Ecto Schemas (Tutorial Data)
✅ **Included in main**
- `lib/selecto_northwind/support/comment.ex` - Polymorphic comment schema
- `lib/selecto_northwind/support/flag_type.ex` - EAV flag type schema
- `lib/selecto_northwind/support/product_flag.ex` - EAV product flag schema

**Why:** These define the data structures for tutorial demonstrations.

### Seed Data (Tutorial Data)
✅ **Included in main**
- `lib/selecto_northwind/seeds/northwind_seeder.ex` - Includes functions:
  - `seed_flag_types/0` - Seeds 7 flag types
  - `seed_product_flags/0` - Seeds ~63 product flags
  - `seed_comments/0` - Seeds 25 comments (polymorphic)

**Why:** Provides test data for tutorial examples.

### Documentation
✅ **Included in main**
- `NORTHWIND_SETUP.md` - Database schema documentation
- Tutorial files in `lib/selecto_northwind_web/controllers/tutorial_html/`

**Why:** Essential reference material for developers.

## Files NOT in Main (Generated by Tutorial Steps)

### Step 1: Add Dependencies
**Generated by:** User manually edits `mix.exs`
- `mix.exs` changes (add selecto, selecto_components, selecto_mix)
- `mix.lock` updates

### Step 2+: Domain Generation
**Generated by:** `mix selecto.gen.domain` commands

❌ **NOT in main** - Created during tutorial:
- `lib/selecto_northwind/selecto_domains/*.ex` - Domain configurations
- `lib/selecto_northwind_web/*_live.ex` - LiveView modules
- `lib/selecto_northwind_web/live/*.html.heex` - LiveView templates
- `lib/selecto_northwind/saved_view.ex` - Saved views schema
- `lib/selecto_northwind/saved_view_context.ex` - Saved views context
- `priv/repo/migrations/*_create_saved_views.exs` - Saved views migration

**Why:** These files demonstrate what the selecto_mix generators produce.

## Tutorial Workflow

### Starting Point (main branch)
```bash
git checkout main
mix setup  # Creates DB, runs migrations, seeds data
```

**Available data:**
- ✅ Standard Northwind data (customers, products, orders, etc.)
- ✅ Comments table (polymorphic demo)
- ✅ Flag types and product flags (EAV demo)
- ✅ 25 comments, 7 flag types, ~63 product flags seeded

### Step 1: Add Selecto Dependencies
```bash
# User edits mix.exs to add:
{:selecto, path: "./vendor/selecto"},
{:selecto_components, path: "./vendor/selecto_components"},
{:selecto_mix, path: "./vendor/selecto_mix", only: [:dev, :test]}

mix deps.get
```

### Step 2+: Generate Domains
```bash
# Products with special join modes
mix selecto.gen.domain SelectoNorthwind.Catalog.Product \
  --expand-lookup Category:category_name \
  --expand-star Supplier:company_name \
  --expand-tag Tags:name \
  --live --saved-views --path products_selecto

# Polymorphic comments (auto-detects commentable_type + commentable_id)
mix selecto.gen.domain SelectoNorthwind.Support.Comment

# Or with custom field names:
mix selecto.gen.domain SelectoNorthwind.Support.Comment \
  --expand-polymorphic target:target_type,target_id:Product,Order,Customer
```

## Verification

### Check Main Branch State
```bash
git checkout main

# Should have migrations/schemas but NO generated domains
ls lib/selecto_northwind/support/
# comment.ex  flag_type.ex  product_flag.ex ✓

ls lib/selecto_northwind/selecto_domains/
# (directory shouldn't exist yet) ✓

# Verify tutorial data exists
mix ecto.reset
# Should seed comments, flag_types, product_flags ✓
```

### After Tutorial Step 2
```bash
# After running mix selecto.gen.domain commands
ls lib/selecto_northwind/selecto_domains/
# product_domain.ex ✓

ls lib/selecto_northwind_web/
# product_live.ex ✓
```

## Design Philosophy

**Main branch = Tutorial Foundation**
- Database schema for realistic demos
- Seed data for testing
- Documentation and guides
- NO generated code

**Tutorial Steps = Generation Examples**
- Users follow steps
- Run mix tasks
- See exactly what gets generated
- Understand the development workflow

This separation makes it clear:
1. What the template provides (data, structure)
2. What the generators create (domains, LiveViews)
3. How developers use selecto_mix in real projects

## For Contributors

### Adding to Main Branch
**Do include:**
- New migrations for tutorial demo data
- New schemas for tutorial examples
- Seed data for demonstrations
- Documentation updates

**Do NOT include:**
- Generated domain files
- Generated LiveView files
- Generated saved view files
- User-specific config (mix.exs selecto deps)

### Testing Main Branch
```bash
git checkout main
mix setup
mix test
mix ecto.reset  # Verify seeds work
```

Should complete without errors, with database ready for tutorial.
